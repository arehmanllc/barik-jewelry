{{ 'accordion.css' | asset_url | stylesheet_tag }}
{%- liquid
  assign unique_id = section.id | slice: -7, 7

  assign section_padding = ''
  if section.settings.section_padding == 'top'
    assign section_padding = 'mb0'
  elsif section.settings.section_padding == 'bottom'
    assign section_padding = 'mt0'
  elsif section.settings.section_padding == 'none'
    assign section_padding = 'mt0 mb0'
  endif

  assign heading_align = 'a-center'

-%}

<div class="section-accordion global__section {{ section_padding }} {% if request.visual_preview_mode %}preview-mode{% endif %}"
  data-section-id="{{ section.id }}"
  data-section-type="accordion"
  data-section-loaded="false">

    {% if section.settings.heading != blank %}
      <div class="grid__wrapper">
        {%
          render 'snip-headings',
          align: heading_align,
          grid: 'span-12',
          heading: section.settings.heading
        %}
      </div>
    {% endif %}

    <div
      style="max-width: 900px; margin: 0 auto;"
    >

      {% if section.blocks.size > 0 %}
       {% for block in section.blocks %}

        <details
          class="details"
          {% unless section.settings.allow_multiple %}
            name="{{ section.id }}"
          {% endunless %}
          id="{{ block.id }}"
          {{ block.shopify_attributes }}
        >
          <summary class="details__summary">
            <h3 class="details__title">{{ block.settings.heading }}</h3>
            <div class="details__icon">
              {% render 'snip-icons',
                wrapper: '',
                type: 'apollo',
                icon: 'down-carrot',
                classes: 'details__svg vib-center',
                size: '6px',
                fill: 'var(--accordion-color)',
                hover: 'var(--accordion-color)' %}
            </div>
          </summary>
          <div class="details__content">
            <div class="rte mb0">
              {{ block.settings.content }}
            </div>
          </div>
        </details>
       {% endfor %}
      {% else %}
        <div class="rte mb0">
          <p>Add accordiond content in the theme editor.</p>
        </div>
      {% endif %}
     </div>
     <style>
       .section-accordion .c-accordion__header {
         text-transform: inherit;
         font-weight: normal !important;
       }
     </style>
</div>

{% schema %}
{
  "name": "Accordion",
  "tag": "section",
  "class": "dynamic-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "FAQs"
    },
    {
      "type": "checkbox",
      "id": "allow_multiple",
      "label": "Allow multiple accordions open at one time",
      "default": false
    },
    {
      "type": "select",
      "id": "section_padding",
      "label": "Section spacing",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        },
        {
          "value": "both",
          "label": "Both"
        },
        {
          "value": "none",
          "label": "None"
        }
      ],
      "default": "both",
      "visible_if": "{{ settings.section_padding > 0 }}"
    }
  ],
  "blocks": [
    {
      "type": "panel",
      "name": "Panel",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Heading"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Content",
          "default": "<p>Use this text to share information about your brand with your customers. Describe a product, share announcements, or welcome customers to your store.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Accordion",
      "blocks": [
        {
          "type": "panel"
        },
        {
          "type": "panel"
        },
        {
          "type": "panel"
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  }
}
{% endschema %}
